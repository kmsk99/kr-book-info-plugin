/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// main.ts
__export(exports, {
  default: () => KrBookInfo
});
var import_obsidian2 = __toModule(require("obsidian"));

// src/crawler.ts
var import_obsidian = __toModule(require("obsidian"));
var searchBookUrl = (keyword) => __async(void 0, null, function* () {
  keyword = encodeURI(keyword);
  try {
    const response = yield (0, import_obsidian.requestUrl)({
      url: "http://www.yes24.com/Product/Search?domain=BOOK&query=" + keyword
    });
    const parser = new DOMParser();
    const html = parser.parseFromString(response.text, "text/html");
    const bookUrl = html.querySelector("#yesSchList > li:nth-child(1) > div > div.item_info > div.info_row.info_name > a.gd_name").getAttribute("href");
    return bookUrl;
  } catch (err) {
    console.log(err);
    return "";
  }
});
var totalSearchBookUrl = (keyword) => __async(void 0, null, function* () {
  keyword = encodeURI(keyword);
  try {
    const response = yield (0, import_obsidian.requestUrl)({
      url: "http://www.yes24.com/Product/Search?domain=ALL&query=" + keyword
    });
    const parser = new DOMParser();
    const html = parser.parseFromString(response.text, "text/html");
    const bookUrl = html.querySelector("#yesSchList > li:nth-child(1) > div > div.item_info > div.info_row.info_name > a.gd_name").getAttribute("href");
    return bookUrl;
  } catch (err) {
    console.log(err);
    return "";
  }
});
var getBookUrl = (keyword) => __async(void 0, null, function* () {
  let bookUrl = yield searchBookUrl(keyword);
  if (!bookUrl)
    bookUrl = yield totalSearchBookUrl(keyword);
  return bookUrl;
});
var getBookInfoResult = (bookUrl) => __async(void 0, null, function* () {
  bookUrl = encodeURI(bookUrl);
  try {
    const response = yield (0, import_obsidian.requestUrl)({
      url: `http://www.yes24.com` + bookUrl
    });
    const parser = new DOMParser();
    const html = parser.parseFromString(response.text, "text/html");
    const tags = [];
    html.querySelectorAll("#infoset_goodsCate > div.infoSetCont_wrap > dl:nth-child(1) > dd > ul > li > a").forEach((value) => {
      tags.push(value.getText().replace(/(\s*)/g, ""));
    });
    const tag = [...new Set(tags)];
    let title = html.querySelector("#yDetailTopWrap > div.topColRgt > div.gd_infoTop > div > h2").getText().replace(/\(.*\)/gi, "").replace(/\[.*\]/gi, "").replace(":", "\uFF1A").replace("?", "\uFF1F").trim();
    let subTitle = html.querySelector("#yDetailTopWrap > div.topColRgt > div.gd_infoTop > div > h3");
    if (subTitle) {
      title = title + "\uFF1A" + subTitle.getText().replace(":", "\uFF1A").replace("?", "\uFF1F").trim();
    }
    const author = [];
    html.querySelectorAll("#yDetailTopWrap > div.topColRgt > div.gd_infoTop > span.gd_pubArea > span.gd_auth").forEach((value) => {
      author.push(value.getText().trim());
    });
    let page = +html.querySelector("#infoset_specific > div.infoSetCont_wrap > div > table > tbody > tr:nth-child(2) > td").getText().split(" ")[0].slice(0, -1);
    if (isNaN(page))
      page = 0;
    const publishDate = html.querySelector("#yDetailTopWrap > div.topColRgt > div.gd_infoTop > span.gd_pubArea > span.gd_date").getText().split(" ").map((v) => v.slice(0, -1)).join("-");
    const coverUrl = html.querySelector("#yDetailTopWrap > div.topColLft > div > span > em > img").getAttribute("src");
    const frontmatter = {
      created: `${new Date(+new Date() + 3240 * 1e4).toISOString().split("T")[0] + " " + new Date().toTimeString().split(" ")[0].slice(0, 5)}`,
      tag: `\u{1F4DA}\uB3C5\uC11C ${tag.join(" ")}`,
      title: `${title}`,
      author: `${author.join(", ")}`,
      category: `${tag[1]}`,
      total_page: page,
      publish_date: `${publishDate}`,
      cover_url: `${coverUrl}`,
      status: `\u{1F7E9} \uC644\uB8CC`,
      start_read_date: `${new Date(+new Date() + 3240 * 1e4).toISOString().split("T")[0]}`,
      finish_read_date: `${new Date(+new Date() + 3240 * 1e4).toISOString().split("T")[0]}`,
      my_rate: 0,
      book_note: `\u274C`
    };
    const result = `---
${(0, import_obsidian.stringifyYaml)(frontmatter)}---

# ${title}`;
    return [
      title.replace("\uFF1A", " ").replace("\uFF1F", "").replace("/", "\uFF0F").replace(/\s{2,}/gi, " "),
      result
    ];
  } catch (err) {
    console.log(err);
    return ["", ""];
  }
});
var getBook = (keyword) => __async(void 0, null, function* () {
  const bookUrl = yield getBookUrl(keyword);
  if (!bookUrl) {
    return [keyword, `${keyword} No title found`];
  }
  const [title, result] = yield getBookInfoResult(bookUrl);
  if (!result) {
    return [keyword, `${keyword} No title found`];
  }
  return [title, result];
});

// main.ts
var KrBookInfo = class extends import_obsidian2.Plugin {
  onload() {
    return __async(this, null, function* () {
      this.addRibbonIcon("lines-of-text", "Add Book Info", (evt) => __async(this, null, function* () {
        const file = this.app.workspace.getActiveFile();
        if (file.extension !== "md") {
          new import_obsidian2.Notice("This file is not md file, Please open md file");
          return;
        }
        if (!file) {
          new import_obsidian2.Notice("There's no active file, Please open new file");
          return;
        }
        new import_obsidian2.Notice("Loading...");
        const [title, result] = yield getBook(file.basename);
        const text = yield this.app.vault.read(file);
        this.app.vault.modify(file, result + "\n\n" + text);
        const regExp = /[\{\}\[\]\/?.,;:|\)*~`!^\-+<>@\#$%&\\\=\(\'\"]/gi;
        const fileName = title.replace(regExp, "");
        this.app.fileManager.renameFile(this.app.vault.getAbstractFileByPath(file.path), file.parent.path + "/" + fileName + ".md");
        new import_obsidian2.Notice("Success!");
        return;
      }));
    });
  }
  onunload() {
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvY3Jhd2xlci50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgTm90aWNlLCBQbHVnaW4gfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgZ2V0Qm9vayB9IGZyb20gXCJzcmMvY3Jhd2xlclwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgS3JCb29rSW5mbyBleHRlbmRzIFBsdWdpbiB7XHJcblx0YXN5bmMgb25sb2FkKCkge1xyXG5cdFx0Ly8gVGhpcyBjcmVhdGVzIGFuIGljb24gaW4gdGhlIGxlZnQgcmliYm9uLlxyXG5cdFx0dGhpcy5hZGRSaWJib25JY29uKFxyXG5cdFx0XHRcImxpbmVzLW9mLXRleHRcIixcclxuXHRcdFx0XCJBZGQgQm9vayBJbmZvXCIsXHJcblx0XHRcdGFzeW5jIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcclxuXHRcdFx0XHQvLyBjaGVjayBjdXJyZW50IGFjdGl2ZSBmaWxlXHJcblx0XHRcdFx0Y29uc3QgZmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcblxyXG5cdFx0XHRcdGlmIChmaWxlLmV4dGVuc2lvbiAhPT0gXCJtZFwiKSB7XHJcblx0XHRcdFx0XHRuZXcgTm90aWNlKFwiVGhpcyBmaWxlIGlzIG5vdCBtZCBmaWxlLCBQbGVhc2Ugb3BlbiBtZCBmaWxlXCIpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0aWYgKCFmaWxlKSB7XHJcblx0XHRcdFx0XHRuZXcgTm90aWNlKFwiVGhlcmUncyBubyBhY3RpdmUgZmlsZSwgUGxlYXNlIG9wZW4gbmV3IGZpbGVcIik7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvLyBDYWxsZWQgd2hlbiB0aGUgdXNlciBjbGlja3MgdGhlIGljb24uXHJcblx0XHRcdFx0bmV3IE5vdGljZShcIkxvYWRpbmcuLi5cIik7XHJcblxyXG5cdFx0XHRcdC8vIFNlYXJjaCBib29rIHRocm91Z2ggY3VycmVudCBmaWxlJ3MgdGl0bGVcclxuXHRcdFx0XHRjb25zdCBbdGl0bGUsIHJlc3VsdF0gPSBhd2FpdCBnZXRCb29rKGZpbGUuYmFzZW5hbWUpO1xyXG5cclxuXHRcdFx0XHQvLyBjaGVjayBmaWxlJ3MgdGV4dFxyXG5cdFx0XHRcdGNvbnN0IHRleHQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xyXG5cclxuXHRcdFx0XHQvLyBqb2luIEZyb250bWF0dGVyIEFuZCB0ZXh0XHJcblx0XHRcdFx0dGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIHJlc3VsdCArIFwiXFxuXFxuXCIgKyB0ZXh0KTtcclxuXHJcblx0XHRcdFx0Y29uc3QgcmVnRXhwID1cclxuXHRcdFx0XHRcdC9bXFx7XFx9XFxbXFxdXFwvPy4sOzp8XFwpKn5gIV5cXC0rPD5AXFwjJCUmXFxcXFxcPVxcKFxcJ1xcXCJdL2dpO1xyXG5cclxuXHRcdFx0XHQvLyBzYW5pdGl6aW5nIHRoZSB0aXRsZVxyXG5cdFx0XHRcdGNvbnN0IGZpbGVOYW1lID0gdGl0bGUucmVwbGFjZShyZWdFeHAsIFwiXCIpO1xyXG5cclxuXHRcdFx0XHQvLyBjaGFuZ2UgZmlsZSBuYW1lXHJcblx0XHRcdFx0dGhpcy5hcHAuZmlsZU1hbmFnZXIucmVuYW1lRmlsZShcclxuXHRcdFx0XHRcdHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlLnBhdGgpLFxyXG5cdFx0XHRcdFx0ZmlsZS5wYXJlbnQucGF0aCArIFwiL1wiICsgZmlsZU5hbWUgKyBcIi5tZFwiXHJcblx0XHRcdFx0KTtcclxuXHJcblx0XHRcdFx0bmV3IE5vdGljZShcIlN1Y2Nlc3MhXCIpO1xyXG5cclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHRcdCk7XHJcblx0fVxyXG5cclxuXHRvbnVubG9hZCgpIHt9XHJcbn1cclxuIiwgImltcG9ydCB7IHJlcXVlc3RVcmwsIHN0cmluZ2lmeVlhbWwgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuLy8gc2VhcmNoIGtleXdvcmQgYW5kIHJldHVybiB5ZXMyNCBzZWFyY2ggcmVzdWx0IGZyb20gXHVBRDZEXHVCMEI0XHVCM0M0XHVDMTFDXG5jb25zdCBzZWFyY2hCb29rVXJsID0gYXN5bmMgKGtleXdvcmQ6IHN0cmluZykgPT4ge1xuXHRrZXl3b3JkID0gZW5jb2RlVVJJKGtleXdvcmQpO1xuXHR0cnkge1xuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh7XG5cdFx0XHR1cmw6XG5cdFx0XHRcdFwiaHR0cDovL3d3dy55ZXMyNC5jb20vUHJvZHVjdC9TZWFyY2g/ZG9tYWluPUJPT0smcXVlcnk9XCIgK1xuXHRcdFx0XHRrZXl3b3JkLFxuXHRcdH0pO1xuXG5cdFx0Y29uc3QgcGFyc2VyID0gbmV3IERPTVBhcnNlcigpO1xuXHRcdGNvbnN0IGh0bWwgPSBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKHJlc3BvbnNlLnRleHQsIFwidGV4dC9odG1sXCIpO1xuXG5cdFx0Y29uc3QgYm9va1VybCA9IGh0bWxcblx0XHRcdC5xdWVyeVNlbGVjdG9yKFxuXHRcdFx0XHRcIiN5ZXNTY2hMaXN0ID4gbGk6bnRoLWNoaWxkKDEpID4gZGl2ID4gZGl2Lml0ZW1faW5mbyA+IGRpdi5pbmZvX3Jvdy5pbmZvX25hbWUgPiBhLmdkX25hbWVcIlxuXHRcdFx0KVxuXHRcdFx0LmdldEF0dHJpYnV0ZShcImhyZWZcIik7XG5cblx0XHRyZXR1cm4gYm9va1VybDtcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0Y29uc29sZS5sb2coZXJyKTtcblx0XHRyZXR1cm4gXCJcIjtcblx0fVxufTtcblxuLy8gc2VhcmNoIGtleXdvcmQgYW5kIHJldHVybiB5ZXMyNCBzZWFyY2ggcmVzdWx0IGZyb20gXHVEMUI1XHVENTY5XHVBQzgwXHVDMEM5XG5jb25zdCB0b3RhbFNlYXJjaEJvb2tVcmwgPSBhc3luYyAoa2V5d29yZDogc3RyaW5nKSA9PiB7XG5cdGtleXdvcmQgPSBlbmNvZGVVUkkoa2V5d29yZCk7XG5cdHRyeSB7XG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHtcblx0XHRcdHVybDpcblx0XHRcdFx0XCJodHRwOi8vd3d3LnllczI0LmNvbS9Qcm9kdWN0L1NlYXJjaD9kb21haW49QUxMJnF1ZXJ5PVwiICtcblx0XHRcdFx0a2V5d29yZCxcblx0XHR9KTtcblxuXHRcdGNvbnN0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcblx0XHRjb25zdCBodG1sID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyhyZXNwb25zZS50ZXh0LCBcInRleHQvaHRtbFwiKTtcblxuXHRcdGNvbnN0IGJvb2tVcmwgPSBodG1sXG5cdFx0XHQucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XCIjeWVzU2NoTGlzdCA+IGxpOm50aC1jaGlsZCgxKSA+IGRpdiA+IGRpdi5pdGVtX2luZm8gPiBkaXYuaW5mb19yb3cuaW5mb19uYW1lID4gYS5nZF9uYW1lXCJcblx0XHRcdClcblx0XHRcdC5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpO1xuXG5cdFx0cmV0dXJuIGJvb2tVcmw7XG5cdH0gY2F0Y2ggKGVycikge1xuXHRcdGNvbnNvbGUubG9nKGVycik7XG5cdFx0cmV0dXJuIFwiXCI7XG5cdH1cbn07XG5cbi8vIGdldCBib29rIHVybFxuLy8gaWYgbm90IHNlYXJjaGVkIGluIFx1QUQ2RFx1QjBCNFx1QjNDNFx1QzExQywgcmVzZWFyY2ggYXQgXHVEMUI1XHVENTY5XHVBQzgwXHVDMEM5IGFuZCByZXR1cm4gdXJsXG5jb25zdCBnZXRCb29rVXJsID0gYXN5bmMgKGtleXdvcmQ6IHN0cmluZykgPT4ge1xuXHRsZXQgYm9va1VybCA9IGF3YWl0IHNlYXJjaEJvb2tVcmwoa2V5d29yZCk7XG5cblx0aWYgKCFib29rVXJsKSBib29rVXJsID0gYXdhaXQgdG90YWxTZWFyY2hCb29rVXJsKGtleXdvcmQpO1xuXG5cdHJldHVybiBib29rVXJsO1xufTtcblxuLy8gZ290byBib29rIGluZm9cbi8vIGlmIGJvb2sgaGFzIHN1YiB0aXRsZSwgdGl0bGUgd2lsbCBiZSBtZXJnZWRcbi8vIGlmIHBhZ2UgaXMgbm90IG51bWJlciwgY29udmVydCBpbnRvIDBcbmNvbnN0IGdldEJvb2tJbmZvUmVzdWx0ID0gYXN5bmMgKGJvb2tVcmw6IHN0cmluZykgPT4ge1xuXHRib29rVXJsID0gZW5jb2RlVVJJKGJvb2tVcmwpO1xuXHR0cnkge1xuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh7XG5cdFx0XHR1cmw6IGBodHRwOi8vd3d3LnllczI0LmNvbWAgKyBib29rVXJsLFxuXHRcdH0pO1xuXG5cdFx0Y29uc3QgcGFyc2VyID0gbmV3IERPTVBhcnNlcigpO1xuXHRcdGNvbnN0IGh0bWwgPSBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKHJlc3BvbnNlLnRleHQsIFwidGV4dC9odG1sXCIpO1xuXG5cdFx0Y29uc3QgdGFnczogc3RyaW5nW10gPSBbXTtcblxuXHRcdGh0bWwucXVlcnlTZWxlY3RvckFsbChcblx0XHRcdFwiI2luZm9zZXRfZ29vZHNDYXRlID4gZGl2LmluZm9TZXRDb250X3dyYXAgPiBkbDpudGgtY2hpbGQoMSkgPiBkZCA+IHVsID4gbGkgPiBhXCJcblx0XHQpLmZvckVhY2goKHZhbHVlKSA9PiB7XG5cdFx0XHR0YWdzLnB1c2godmFsdWUuZ2V0VGV4dCgpLnJlcGxhY2UoLyhcXHMqKS9nLCBcIlwiKSk7XG5cdFx0fSk7XG5cblx0XHRjb25zdCB0YWcgPSBbLi4ubmV3IFNldCh0YWdzKV07XG5cblx0XHRsZXQgdGl0bGUgPSBodG1sXG5cdFx0XHQucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XCIjeURldGFpbFRvcFdyYXAgPiBkaXYudG9wQ29sUmd0ID4gZGl2LmdkX2luZm9Ub3AgPiBkaXYgPiBoMlwiXG5cdFx0XHQpXG5cdFx0XHQuZ2V0VGV4dCgpXG5cdFx0XHQucmVwbGFjZSgvXFwoLipcXCkvZ2ksIFwiXCIpXG5cdFx0XHQucmVwbGFjZSgvXFxbLipcXF0vZ2ksIFwiXCIpXG5cdFx0XHQucmVwbGFjZShcIjpcIiwgXCJcdUZGMUFcIilcblx0XHRcdC5yZXBsYWNlKFwiP1wiLCBcIlx1RkYxRlwiKVxuXHRcdFx0LnRyaW0oKTtcblxuXHRcdGxldCBzdWJUaXRsZSA9IGh0bWwucXVlcnlTZWxlY3Rvcihcblx0XHRcdFwiI3lEZXRhaWxUb3BXcmFwID4gZGl2LnRvcENvbFJndCA+IGRpdi5nZF9pbmZvVG9wID4gZGl2ID4gaDNcIlxuXHRcdCk7XG5cblx0XHRpZiAoc3ViVGl0bGUpIHtcblx0XHRcdHRpdGxlID1cblx0XHRcdFx0dGl0bGUgK1xuXHRcdFx0XHRcIlx1RkYxQVwiICtcblx0XHRcdFx0c3ViVGl0bGUuZ2V0VGV4dCgpLnJlcGxhY2UoXCI6XCIsIFwiXHVGRjFBXCIpLnJlcGxhY2UoXCI/XCIsIFwiXHVGRjFGXCIpLnRyaW0oKTtcblx0XHR9XG5cblx0XHRjb25zdCBhdXRob3I6IHN0cmluZ1tdID0gW107XG5cblx0XHRodG1sLnF1ZXJ5U2VsZWN0b3JBbGwoXG5cdFx0XHRcIiN5RGV0YWlsVG9wV3JhcCA+IGRpdi50b3BDb2xSZ3QgPiBkaXYuZ2RfaW5mb1RvcCA+IHNwYW4uZ2RfcHViQXJlYSA+IHNwYW4uZ2RfYXV0aFwiXG5cdFx0KS5mb3JFYWNoKCh2YWx1ZSkgPT4ge1xuXHRcdFx0YXV0aG9yLnB1c2godmFsdWUuZ2V0VGV4dCgpLnRyaW0oKSk7XG5cdFx0fSk7XG5cblx0XHRsZXQgcGFnZSA9ICtodG1sXG5cdFx0XHQucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XCIjaW5mb3NldF9zcGVjaWZpYyA+IGRpdi5pbmZvU2V0Q29udF93cmFwID4gZGl2ID4gdGFibGUgPiB0Ym9keSA+IHRyOm50aC1jaGlsZCgyKSA+IHRkXCJcblx0XHRcdClcblx0XHRcdC5nZXRUZXh0KClcblx0XHRcdC5zcGxpdChcIiBcIilbMF1cblx0XHRcdC5zbGljZSgwLCAtMSk7XG5cblx0XHRpZiAoaXNOYU4ocGFnZSkpIHBhZ2UgPSAwO1xuXG5cdFx0Y29uc3QgcHVibGlzaERhdGUgPSBodG1sXG5cdFx0XHQucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XCIjeURldGFpbFRvcFdyYXAgPiBkaXYudG9wQ29sUmd0ID4gZGl2LmdkX2luZm9Ub3AgPiBzcGFuLmdkX3B1YkFyZWEgPiBzcGFuLmdkX2RhdGVcIlxuXHRcdFx0KVxuXHRcdFx0LmdldFRleHQoKVxuXHRcdFx0LnNwbGl0KFwiIFwiKVxuXHRcdFx0Lm1hcCgodikgPT4gdi5zbGljZSgwLCAtMSkpXG5cdFx0XHQuam9pbihcIi1cIik7XG5cblx0XHRjb25zdCBjb3ZlclVybCA9IGh0bWxcblx0XHRcdC5xdWVyeVNlbGVjdG9yKFxuXHRcdFx0XHRcIiN5RGV0YWlsVG9wV3JhcCA+IGRpdi50b3BDb2xMZnQgPiBkaXYgPiBzcGFuID4gZW0gPiBpbWdcIlxuXHRcdFx0KVxuXHRcdFx0LmdldEF0dHJpYnV0ZShcInNyY1wiKTtcblxuXHRcdGNvbnN0IGZyb250bWF0dGVyID0ge1xuXHRcdFx0Y3JlYXRlZDogYCR7XG5cdFx0XHRcdG5ldyBEYXRlKCtuZXcgRGF0ZSgpICsgMzI0MCAqIDEwMDAwKVxuXHRcdFx0XHRcdC50b0lTT1N0cmluZygpXG5cdFx0XHRcdFx0LnNwbGl0KFwiVFwiKVswXSArXG5cdFx0XHRcdFwiIFwiICtcblx0XHRcdFx0bmV3IERhdGUoKS50b1RpbWVTdHJpbmcoKS5zcGxpdChcIiBcIilbMF0uc2xpY2UoMCwgNSlcblx0XHRcdH1gLFxuXHRcdFx0dGFnOiBgXHVEODNEXHVEQ0RBXHVCM0M1XHVDMTFDICR7dGFnLmpvaW4oXCIgXCIpfWAsXG5cdFx0XHR0aXRsZTogYCR7dGl0bGV9YCxcblx0XHRcdGF1dGhvcjogYCR7YXV0aG9yLmpvaW4oXCIsIFwiKX1gLFxuXHRcdFx0Y2F0ZWdvcnk6IGAke3RhZ1sxXX1gLFxuXHRcdFx0dG90YWxfcGFnZTogcGFnZSxcblx0XHRcdHB1Ymxpc2hfZGF0ZTogYCR7cHVibGlzaERhdGV9YCxcblx0XHRcdGNvdmVyX3VybDogYCR7Y292ZXJVcmx9YCxcblx0XHRcdHN0YXR1czogYFx1RDgzRFx1REZFOSBcdUM2NDRcdUI4Q0NgLFxuXHRcdFx0c3RhcnRfcmVhZF9kYXRlOiBgJHtcblx0XHRcdFx0bmV3IERhdGUoK25ldyBEYXRlKCkgKyAzMjQwICogMTAwMDApLnRvSVNPU3RyaW5nKCkuc3BsaXQoXCJUXCIpWzBdXG5cdFx0XHR9YCxcblx0XHRcdGZpbmlzaF9yZWFkX2RhdGU6IGAke1xuXHRcdFx0XHRuZXcgRGF0ZSgrbmV3IERhdGUoKSArIDMyNDAgKiAxMDAwMCkudG9JU09TdHJpbmcoKS5zcGxpdChcIlRcIilbMF1cblx0XHRcdH1gLFxuXHRcdFx0bXlfcmF0ZTogMCxcblx0XHRcdGJvb2tfbm90ZTogYFx1Mjc0Q2AsXG5cdFx0fTtcblxuXHRcdGNvbnN0IHJlc3VsdCA9IGAtLS1cbiR7c3RyaW5naWZ5WWFtbChmcm9udG1hdHRlcil9LS0tXG5cbiMgJHt0aXRsZX1gO1xuXG5cdFx0cmV0dXJuIFtcblx0XHRcdHRpdGxlXG5cdFx0XHRcdC5yZXBsYWNlKFwiXHVGRjFBXCIsIFwiIFwiKVxuXHRcdFx0XHQucmVwbGFjZShcIlx1RkYxRlwiLCBcIlwiKVxuXHRcdFx0XHQucmVwbGFjZShcIi9cIiwgXCJcdUZGMEZcIilcblx0XHRcdFx0LnJlcGxhY2UoL1xcc3syLH0vZ2ksIFwiIFwiKSxcblx0XHRcdHJlc3VsdCxcblx0XHRdO1xuXHR9IGNhdGNoIChlcnIpIHtcblx0XHRjb25zb2xlLmxvZyhlcnIpO1xuXHRcdHJldHVybiBbXCJcIiwgXCJcIl07XG5cdH1cbn07XG5cbi8vIGdldCBib29rJ3MgaW5mbyBhbmQgcmV0dXJuIGZyb250bWF0dGVyXG5jb25zdCBnZXRCb29rID0gYXN5bmMgKGtleXdvcmQ6IHN0cmluZykgPT4ge1xuXHRjb25zdCBib29rVXJsID0gYXdhaXQgZ2V0Qm9va1VybChrZXl3b3JkKTtcblxuXHRpZiAoIWJvb2tVcmwpIHtcblx0XHRyZXR1cm4gW2tleXdvcmQsIGAke2tleXdvcmR9IE5vIHRpdGxlIGZvdW5kYF07XG5cdH1cblxuXHRjb25zdCBbdGl0bGUsIHJlc3VsdF0gPSBhd2FpdCBnZXRCb29rSW5mb1Jlc3VsdChib29rVXJsKTtcblxuXHRpZiAoIXJlc3VsdCkge1xuXHRcdHJldHVybiBba2V5d29yZCwgYCR7a2V5d29yZH0gTm8gdGl0bGUgZm91bmRgXTtcblx0fVxuXG5cdHJldHVybiBbdGl0bGUsIHJlc3VsdF07XG59O1xuXG5leHBvcnQgeyBnZXRCb29rIH07XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBLHVCQUErQjs7O0FDQS9CLHNCQUEwQztBQUcxQyxJQUFNLGdCQUFnQixDQUFPLFlBQW9CO0FBQ2hELFlBQVUsVUFBVTtBQUNwQixNQUFJO0FBQ0gsVUFBTSxXQUFXLE1BQU0sZ0NBQVc7QUFBQSxNQUNqQyxLQUNDLDJEQUNBO0FBQUE7QUFHRixVQUFNLFNBQVMsSUFBSTtBQUNuQixVQUFNLE9BQU8sT0FBTyxnQkFBZ0IsU0FBUyxNQUFNO0FBRW5ELFVBQU0sVUFBVSxLQUNkLGNBQ0EsNEZBRUEsYUFBYTtBQUVmLFdBQU87QUFBQSxXQUNDLEtBQVA7QUFDRCxZQUFRLElBQUk7QUFDWixXQUFPO0FBQUE7QUFBQTtBQUtULElBQU0scUJBQXFCLENBQU8sWUFBb0I7QUFDckQsWUFBVSxVQUFVO0FBQ3BCLE1BQUk7QUFDSCxVQUFNLFdBQVcsTUFBTSxnQ0FBVztBQUFBLE1BQ2pDLEtBQ0MsMERBQ0E7QUFBQTtBQUdGLFVBQU0sU0FBUyxJQUFJO0FBQ25CLFVBQU0sT0FBTyxPQUFPLGdCQUFnQixTQUFTLE1BQU07QUFFbkQsVUFBTSxVQUFVLEtBQ2QsY0FDQSw0RkFFQSxhQUFhO0FBRWYsV0FBTztBQUFBLFdBQ0MsS0FBUDtBQUNELFlBQVEsSUFBSTtBQUNaLFdBQU87QUFBQTtBQUFBO0FBTVQsSUFBTSxhQUFhLENBQU8sWUFBb0I7QUFDN0MsTUFBSSxVQUFVLE1BQU0sY0FBYztBQUVs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
